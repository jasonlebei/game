
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶£å‘³æ•°å­¦ç®—å¼é…å¯¹æ¸¸æˆ</title>
    <style>
        /* å…¨å±€æ ·å¼é‡ç½®ä¸åŸºç¡€è®¾ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤ç§»åŠ¨ç«¯ç‚¹å‡»é«˜äº® */
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            min-height: 100vh;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }

        /* è£…é¥°å…ƒç´  */
        body::before, body::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            z-index: -1;
        }

        body::before {
            width: 200px;
            height: 200px;
            top: 10%;
            left: 10%;
        }

        body::after {
            width: 150px;
            height: 150px;
            bottom: 10%;
            right: 10%;
        }

        /* æ ‡é¢˜æ ·å¼ */
        .game-header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            background: linear-gradient(to right, #ffecd2, #fcb69f);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* æ¸¸æˆä¿¡æ¯é¢æ¿ */
        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 12px 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .score {
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .score i {
            color: #ffd700;
        }

        .progress {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .progress-bar {
            width: 80px;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* è‡ªå®šä¹‰å¼¹çª—æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 320px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .modal-text {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .modal-score {
            font-size: 18px;
            color: #666;
            margin-bottom: 25px;
        }

        .modal-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            background: linear-gradient(135deg, #3a86ff, #2667ff);
            color: white;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(58, 134, 255, 0.4);
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 5px;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            color: #2c3e50;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        /* å¡ç‰‡è£…é¥°æ•ˆæœ */
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        /* å·²é€‰ä¸­å¡ç‰‡ */
        .card.selected {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            transform: scale(0.98);
        }

        /* å·²é…å¯¹å¡ç‰‡ */
        .card.matched {
            background: linear-gradient(135deg, #4ecdc4, #45b7a0);
            color: white;
            cursor: default;
            transform: scale(0.95);
            animation: pulse 0.5s ease-in-out;
        }

        /* é…å¯¹æˆåŠŸåŠ¨ç”» */
        @keyframes pulse {
            0% { transform: scale(0.95); }
            50% { transform: scale(1.05); }
            100% { transform: scale(0.95); }
        }

        /* æŒ‰é’®å®¹å™¨ */
        .controls {
            display: flex;
            gap: 15px;
            margin: 30px 0 20px;
            width: 100%;
            max-width: 500px;
            justify-content: center;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            flex: 1;
            max-width: 200px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3a86ff, #2667ff);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #8338ec, #6a2cd7);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(1px);
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 480px) {
            h1 {
                font-size: 24px;
            }
            
            .game-info {
                padding: 10px 15px;
            }
            
            .score, .progress {
                font-size: 18px;
            }
            
            .card {
                height: 70px;
                font-size: 16px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 15px;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .modal-icon {
                font-size: 40px;
            }
            
            .modal-text {
                font-size: 20px;
            }
        }

        /* æ¨ªå±é€‚é… */
        @media (orientation: landscape) and (max-height: 500px) {
            body {
                padding: 10px;
            }
            
            .game-header {
                margin-bottom: 10px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .game-info {
                margin-bottom: 10px;
            }
            
            .card {
                height: 60px;
            }
            
            .controls {
                margin: 15px 0 10px;
            }
        }
    </style>
</head>
<body>
    <div class="game-header">
        <h1>è¶£å‘³æ•°å­¦ç®—å¼é…å¯¹æ¸¸æˆ</h1>
    </div>
    
    <div class="game-info">
        <div class="score">
            <i>â­</i> å¾—åˆ†: <span id="score">0</span>
        </div>
        <div class="progress">
            è¿›åº¦: 
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <span id="progressText">0/6</span>
        </div>
    </div>
    
    <!-- è‡ªå®šä¹‰å¼¹çª— -->
    <div class="modal" id="messageModal">
        <div class="modal-content">
            <span class="modal-icon" id="modalIcon">ğŸ‰</span>
            <div class="modal-text" id="modalText">é…å¯¹æˆåŠŸï¼</div>
            <div class="modal-score" id="modalScore">å½“å‰å¾—åˆ†ï¼š0</div>
            <button class="modal-btn" id="modalBtn">ç¡®å®š</button>
        </div>
    </div>
    
    <div class="game-container" id="gameContainer"></div>
    
    <div class="controls">
        <button id="restartBtn" class="btn btn-primary">é‡æ–°å¼€å§‹</button>
        <button id="newGameBtn" class="btn btn-secondary">æ–°æ¸¸æˆ</button>
    </div>

    <script>
        // æ¸¸æˆæ ¸å¿ƒå˜é‡
        let score = 0;
        let selectedCards = [];
        let matchedPairs = 0;
        const totalPairs = 6; // æ€»é…å¯¹æ•°
        let gameData = [];
        let modalTimer = null; // å¼¹çª—å®šæ—¶å™¨

        // DOMå…ƒç´ 
        const gameContainer = document.getElementById('gameContainer');
        const scoreElement = document.getElementById('score');
        const restartBtn = document.getElementById('restartBtn');
        const newGameBtn = document.getElementById('newGameBtn');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        // å¼¹çª—å…ƒç´ 
        const messageModal = document.getElementById('messageModal');
        const modalIcon = document.getElementById('modalIcon');
        const modalText = document.getElementById('modalText');
        const modalScore = document.getElementById('modalScore');
        const modalBtn = document.getElementById('modalBtn');

        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        function updateProgress() {
            const progressPercent = (matchedPairs / totalPairs) * 100;
            progressFill.style.width = `${progressPercent}%`;
            progressText.textContent = `${matchedPairs}/${totalPairs}`;
        }

        // æ˜¾ç¤ºè‡ªå®šä¹‰å¼¹çª—
        function showModal(type, text, canClose = true) {
            // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
            if (modalTimer) clearTimeout(modalTimer);
            
            // è®¾ç½®å¼¹çª—å†…å®¹
            if (type === 'success') {
                modalIcon.textContent = 'ğŸ‰';
                modalText.style.color = '#4ecdc4';
            } else if (type === 'error') {
                modalIcon.textContent = 'ğŸ˜';
                modalText.style.color = '#ff6b6b';
            } else if (type === 'complete') {
                modalIcon.textContent = 'ğŸ†';
                modalText.style.color = '#ffd700';
            }
            
            modalText.textContent = text;
            modalScore.textContent = `å½“å‰å¾—åˆ†ï¼š${score}`;
            
            // æ§åˆ¶å…³é—­æŒ‰é’®æ˜¾ç¤º/éšè—
            if (canClose) {
                modalBtn.style.display = 'block';
            } else {
                modalBtn.style.display = 'none';
            }
            
            // æ˜¾ç¤ºå¼¹çª—
            messageModal.classList.add('show');
            
            // é”™è¯¯å¼¹çª—è‡ªåŠ¨å…³é—­ï¼ˆ1.5ç§’ï¼‰
            if (!canClose) {
                modalTimer = setTimeout(() => {
                    hideModal();
                }, 1500);
            }
        }

        // éšè—è‡ªå®šä¹‰å¼¹çª—
        function hideModal() {
            messageModal.classList.remove('show');
            // æ¸…é™¤å®šæ—¶å™¨
            if (modalTimer) clearTimeout(modalTimer);
        }

        // ç”Ÿæˆéšæœºç®—å¼å’Œç»“æœ
        function generateMathProblems() {
            const problems = [];
            // ç”Ÿæˆ6ç»„åŠ å‡æ³•ç®—å¼ï¼ˆ10ä»¥å†…ï¼‰
            for (let i = 0; i < totalPairs; i++) {
                let num1, num2, operator, result;
                
                // éšæœºé€‰æ‹©åŠ æ³•æˆ–å‡æ³•
                if (Math.random() > 0.5) {
                    // åŠ æ³•
                    num1 = Math.floor(Math.random() * 9) + 1;
                    num2 = Math.floor(Math.random() * 9) + 1;
                    operator = '+';
                    result = num1 + num2;
                } else {
                    // å‡æ³•ï¼ˆç¡®ä¿ç»“æœä¸ºæ­£ï¼‰
                    num1 = Math.floor(Math.random() * 9) + 2;
                    num2 = Math.floor(Math.random() * (num1 - 1)) + 1;
                    operator = '-';
                    result = num1 - num2;
                }

                // æ·»åŠ ç®—å¼å’Œç»“æœåˆ°æ•°ç»„
                problems.push({
                    type: 'equation',
                    content: `${num1} ${operator} ${num2} = ?`,
                    value: result
                });
                problems.push({
                    type: 'answer',
                    content: result,
                    value: result
                });
            }
            
            // éšæœºæ‰“ä¹±æ•°ç»„
            return shuffleArray(problems);
        }

        // æ•°ç»„æ´—ç‰Œå‡½æ•°ï¼ˆFisher-Yatesç®—æ³•ï¼‰
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            score = 0;
            selectedCards = [];
            matchedPairs = 0;
            scoreElement.textContent = score;
            updateProgress();
            
            // éšè—å¼¹çª—
            hideModal();
            
            // ç”Ÿæˆæ–°é¢˜ç›®
            gameData = generateMathProblems();
            
            // æ¸…ç©ºæ¸¸æˆå®¹å™¨
            gameContainer.innerHTML = '';
            
            // åˆ›å»ºå¡ç‰‡
            gameData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.index = index;
                card.dataset.value = item.value;
                card.dataset.type = item.type;
                card.textContent = item.content;
                
                // å¡ç‰‡ç‚¹å‡»äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ä¼˜åŒ–ï¼‰
                card.addEventListener('click', handleCardClick);
                // ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶æ”¯æŒ
                card.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    handleCardClick(e);
                });
                
                gameContainer.appendChild(card);
            });
        }

        // å¤„ç†å¡ç‰‡ç‚¹å‡»
        function handleCardClick(e) {
            const card = e.target;
            
            // è·³è¿‡å·²é…å¯¹æˆ–å·²é€‰ä¸­çš„å¡ç‰‡ï¼Œå¼¹çª—æ˜¾ç¤ºæ—¶ä¹Ÿä¸èƒ½ç‚¹å‡»
            if (card.classList.contains('matched') || 
                card.classList.contains('selected') ||
                messageModal.classList.contains('show')) {
                return;
            }

            // æœ€å¤šåŒæ—¶é€‰ä¸­2å¼ å¡ç‰‡
            if (selectedCards.length >= 2) {
                return;
            }

            // é€‰ä¸­å¡ç‰‡
            card.classList.add('selected');
            selectedCards.push(card);

            // é€‰ä¸­2å¼ å¡ç‰‡æ—¶æ£€æŸ¥é…å¯¹
            if (selectedCards.length === 2) {
                checkMatch();
            }
        }

        // æ£€æŸ¥é…å¯¹æ˜¯å¦æ­£ç¡®
        function checkMatch() {
            const card1 = selectedCards[0];
            const card2 = selectedCards[1];
            
            // åˆ¤æ–­æ¡ä»¶ï¼šå€¼ç›¸ç­‰ + ç±»å‹ä¸åŒï¼ˆä¸€ä¸ªæ˜¯ç®—å¼ï¼Œä¸€ä¸ªæ˜¯ç»“æœï¼‰
            const isMatched = (card1.dataset.value === card2.dataset.value) && 
                              (card1.dataset.type !== card2.dataset.type);

            if (isMatched) {
                // é…å¯¹æˆåŠŸ
                score += 10;
                matchedPairs++;
                scoreElement.textContent = score;
                
                // æ ‡è®°ä¸ºå·²é…å¯¹
                card1.classList.add('matched');
                card2.classList.add('matched');
                
                // ç§»é™¤é€‰ä¸­çŠ¶æ€
                card1.classList.remove('selected');
                card2.classList.remove('selected');
                
                // æ¸…ç©ºé€‰ä¸­æ•°ç»„
                selectedCards = [];
                
                // æ›´æ–°è¿›åº¦
                updateProgress();
                
                // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
                if (matchedPairs === totalPairs) {
                    // æ¸¸æˆå®Œæˆå¼¹çª—ï¼ˆéœ€è¦ç”¨æˆ·å…³é—­ï¼‰
                    setTimeout(() => {
                        showModal('complete', `æ­å–œä½ ï¼å…¨éƒ¨é…å¯¹å®Œæˆï¼æ€»å¾—åˆ†ï¼š${score}`, true);
                    }, 500);
                } else {
                    // é…å¯¹æˆåŠŸå¼¹çª—ï¼ˆéœ€è¦ç”¨æˆ·å…³é—­ï¼‰
                    showModal('success', 'é…å¯¹æˆåŠŸï¼', true);
                }
            } else {
                // é…å¯¹å¤±è´¥
                score = Math.max(0, score - 2); // æ‰£åˆ†ï¼ˆä¸ä½äº0ï¼‰
                scoreElement.textContent = score;
                
                // å¤±è´¥å¼¹çª—ï¼ˆè‡ªåŠ¨å…³é—­ï¼Œä¸å¯æ‰‹åŠ¨å…³é—­ï¼‰
                showModal('error', 'é…å¯¹å¤±è´¥ï¼', false);
                
                // 1ç§’åå–æ¶ˆé€‰ä¸­çŠ¶æ€
                setTimeout(() => {
                    card1.classList.remove('selected');
                    card2.classList.remove('selected');
                    selectedCards = [];
                }, 1000);
            }
        }

        // äº‹ä»¶ç›‘å¬
        restartBtn.addEventListener('click', () => {
            // é‡æ–°å¼€å§‹ï¼ˆä¿ç•™å½“å‰é¢˜ç›®ï¼Œé‡ç½®çŠ¶æ€ï¼‰
            score = 0;
            selectedCards = [];
            matchedPairs = 0;
            scoreElement.textContent = score;
            updateProgress();
            
            // éšè—å¼¹çª—
            hideModal();
            
            // é‡ç½®å¡ç‰‡æ ·å¼
            const allCards = document.querySelectorAll('.card');
            allCards.forEach(card => {
                card.classList.remove('selected', 'matched');
            });
        });

        newGameBtn.addEventListener('click', initGame);

        // å¼¹çª—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        modalBtn.addEventListener('click', hideModal);

        // åˆå§‹åŒ–æ¸¸æˆ
        window.addEventListener('load', initGame);

        // é˜²æ­¢ç§»åŠ¨ç«¯åŒå‡»ç¼©æ”¾
        document.addEventListener('dblclick', (e) => e.preventDefault());
    </script>
</body>
</html>
